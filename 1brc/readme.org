#+title: Billion Row Challange

* Naive (single threaded, scalar) solution

- Majority of time (49.2%) spent extracting city name and temperature from line.

#+begin_example
PROFILER REPORT
===============
total_s: 254.4257 s
Data: 12.8479 GB
throughtput: 0.0505 GB/s

       entry_point_naive: 254425712.1397us (100.0%)	71489751.5481us ( 28.1%)
              line parse: 125283842.1162us ( 49.2%)	64273168.1634us ( 25.3%)
                     cut: 61010673.9527us ( 24.0%)	61010673.9527us ( 24.0%)
       parse_temperature: 21863746.2465us (  8.6%)	21863746.2465us (  8.6%)
                  upsert: 35778943.4726us ( 14.1%)	35778896.6169us ( 14.1%)
#+end_example

* Single threaded, SIMD solution

- 1.6x speedup compared to scalar version

#+begin_example
PROFILER REPORT
===============
total_s: 156.3821 s
Data: 12.8479 GB
throughtput: 0.0822 GB/s

        entry_point_simd: 156382058.6188us (100.0%)      68586256.9632us ( 43.9%)
              line_parse: 36365111.8038us ( 23.3%)       36365111.8038us ( 23.3%)
       parse_temperature: 20102002.5786us ( 12.9%)       20102002.5786us ( 12.9%)
                  upsert: 31328687.2732us ( 20.0%)       31328687.2732us ( 20.0%)
#+end_example

* Multi threaded, SIMD solution

- 12.8x speedup compared to single threaded, scalar version
- 7.9x speedup compared to SIMD version

#+begin_example
total_s: 18.3352 s
Data: 12.8479 GB
throughtput: 0.7007 GB/s

             entry_point: 18335198.9369us (100.0%)       8208914.8622us ( 44.8%) 
              line_parse: 4489316.4556us ( 24.5%)        4489316.4556us ( 24.5%) 
       parse_temperature: 1973260.8807us ( 10.8%)        1973260.8807us ( 10.8%) 
                  upsert: 3663706.7384us ( 20.0%)        3663706.7384us ( 20.0%) 
#+end_example
